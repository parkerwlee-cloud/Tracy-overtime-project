{% extends "_base.html" %}
{% block content %}
<h2>Employees</h2>

<div class="row">
  <div class="card w-33">
    <h3>Add Employee</h3>
    <form method="POST" action="{{ url_for('admin_emp_create') }}">
      <div style="margin-bottom:.5rem"><input name="name" placeholder="Name *" required></div>
      <div style="margin-bottom:.5rem"><input name="clock_number" placeholder="Clock (4 digits) *" pattern="\\d{4}" required></div>
      <div style="margin-bottom:.5rem"><input name="phone" placeholder="Phone (optional)"></div>
      <div style="margin-bottom:.5rem">
        <label>Categories (Ctrl+Click to select multiple)</label><br>
        <select name="categories" multiple size="6" style="min-width:220px">
          {% for c in categories %}
            <option value="{{ c }}">{{ c }}</option>
          {% endfor %}
        </select>
      </div>
      <button class="btn" type="submit">Add</button>
    </form>
  </div>

  <div class="card w-66 w-100">
    <h3>Roster</h3>
    <table>
      <tr>
        <th>Clock</th><th>Name</th><th>Phone</th><th>Categories</th><th>Actions</th>
      </tr>
      {% for e in employees %}
      <tr>
        <td>{{ e.clock_number }}</td>
        <td>{{ e.name }}</td>
        <td>{{ e.phone or '' }}</td>
        <td>
          {% if e.cats %}
            {% for c in e.cats %}<span class="pill">{{ c }}</span>{% endfor %}
          {% else %}
            <em class="muted">none</em>
          {% endif %}
        </td>
        <td>
          <form method="POST" action="{{ url_for('admin_emp_update', emp_id=e.id) }}" style="margin-bottom:.5rem">
            <input name="name" value="{{ e.name }}" placeholder="Name">
            <input name="clock_number" value="{{ e.clock_number }}" pattern="\\d{4}" title="4 digits">
            <input name="phone" value="{{ e.phone or '' }}" placeholder="Phone">
            <select name="categories" multiple size="4">
              {% for c in categories %}
                <option value="{{ c }}" {% if c in e.cats %}selected{% endif %}>{{ c }}</option>
              {% endfor %}
            </select>
            <button class="btn" type="submit">Save</button>
          </form>
          <form method="POST" action="{{ url_for('admin_emp_delete', emp_id=e.id) }}" onsubmit="return confirm('Delete employee? (Only if no signups)')">
            <button class="btn danger" type="submit">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </table>
  </div>
</div>
{% endblock %}
