{% extends "_base.html" %}
{% block content %}
<h2>Kiosk</h2>

{% for day in grid %}
  <div class="card">
    <div class="row">
      <h3 style="margin:0">{{ day.date }}</h3>
    </div>
    <table>
      <thead>
        <tr>
          <th style="width:120px">Slot</th>
          <th style="width:120px">Taken / Cap</th>
          <th>Sign Up</th>
        </tr>
      </thead>
      <tbody>
      {% for r in day.rows %}
        <tr>
          <td>{{ r.label }}</td>
          <td>{{ r.taken }} / {{ r.capacity }}</td>
          <td>
            {% if r.disabled %}
              <span class="muted">{{ r.state_hint or "Closed" }}</span>
            {% elif r.capacity <= r.taken %}
              <span class="muted">Full</span>
              <form method="post" action="{{ url_for('signup') }}" class="row" style="margin-top:8px; gap:6px">
                <input type="hidden" name="slot_id" value="{{ r.slot_id }}">
                <input name="name" placeholder="Name" required>
                <input name="clock_number" placeholder="Clock #" pattern="\d{4}" required>
                <input name="phone" placeholder="Phone">
                <button class="btn" type="submit">Try to bump</button>
              </form>
            {% else %}
              <form method="post" action="{{ url_for('signup') }}" class="row" style="gap:6px">
                <input type="hidden" name="slot_id" value="{{ r.slot_id }}">
                <input name="name" placeholder="Name" required>
                <input name="clock_number" placeholder="Clock #" pattern="\d{4}" required>
                <input name="phone" placeholder="Phone">
                <button class="btn primary" type="submit">Sign up</button>
              </form>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
{% endfor %}

{% endblock %}
